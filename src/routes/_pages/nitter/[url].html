<style>
  .nitter-frame {
    width: 100%;
    border: none;
    min-height: 100vh;
    outline: none;
  }
</style>
<script>
    import { store } from '../../_store/store.js'
    import iframeResizer from 'iframe-resizer';
    import DynamicPageBanner from '../../_components/DynamicPageBanner.html'
    let loading = true;
    export default {
      computed: {
        url: ({ params }) => "https://pinafore-themed-nitter.easrng.workers.dev/"+params.url,
      },
      store: () => store,
      oncreate() {
        iframeResizer.iframeResize({log:true, initCallback: (...args)=>{
          console.debug("init", args)
          this.refs.frame.iFrameResizer.sendMessage({theme:location.origin+`/theme-${__store.get().currentTheme}.css`})
        }, onMessage: ({url, unload})=>{
          if(url) {
            console.warn("navigated to", url)
            loading=false
          }
          if(unload) loading=true
        }}, this.refs.frame);
      },
      components: {
        DynamicPageBanner
      }
    }
</script>
<DynamicPageBanner title="" />
{#if loading}
<LoadingPage />
{/if}
<iframe src={url} class="nitter-frame" ref:frame scrolling="no"></iframe>